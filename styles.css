/* ===== iPadOS-Ã¤hnliche Tokens ===== */
:root{
/* Delay tones */
--tone-early: #2e7d32;   /* green 600 */
--tone-warn:  #f9a825;   /* yellow 800 */
--tone-caut:  #ef6c00;   /* orange 800 */
--tone-danger:#e53935;   /* red 600 */

/* Shadows (light) */
--shadow-early:  0 1px 2px rgba(46,125,50,.08), 0 10px 26px rgba(46,125,50,.26), 0 16px 48px rgba(46,125,50,.16);
--shadow-warn:   0 1px 2px rgba(249,168,37,.08), 0 10px 26px rgba(249,168,37,.24), 0 16px 48px rgba(249,168,37,.14);
--shadow-caut:   0 1px 2px rgba(239,108,0,.08),  0 10px 26px rgba(239,108,0,.26),  0 16px 48px rgba(239,108,0,.16);
--shadow-danger: 0 1px 2px rgba(229,57,53,.08),  0 10px 26px rgba(229,57,53,.28),  0 16px 48px rgba(229,57,53,.18);

  --bg:#F9F7F7;
  --panel:#FFFFFF;
  --panel-2:#F3F6FB;
  --bar:#EAF0F7;
  --text:#112D4E;
  --muted:#48658A;
  --rule:#E3E9F2;

  --accent:#3F72AF;
  --ok:#27ae60;
  --bad:#e53935;

  --easing:cubic-bezier(.2,.8,.2,1);
  --fast:160ms;
  --normal:260ms;
  --slow:420ms;

  --shadow:0 1px 2px rgba(17,45,78,.05), 0 8px 24px rgba(17,45,78,.08);
  --shadow-press:0 0.5px 0 rgba(0,0,0,.04), 0 4px 12px rgba(0,0,0,.06);
  --radius:12px;
  --font: ui-system, -apple-system, system-ui, "SF Pro Text", Segoe UI, Roboto, Helvetica, Arial, sans-serif;

  --pill-bg:#F8FBFF;
  --pill-border:#D5E1F2;

  --line-s:   #0AA15A;
  --line-u:   #0F4C75;
  --line-tram:#D81B60;
  --line-bus: #D9822B;
  --line-rb:  #6D4C41;
  --line-re:  #8E24AA;
  --line-ice: #B71C1C;
}
[data-theme="dark"]{
/* Shadows (dark) */
--shadow-early:  0 0 0 1px rgba(46,125,50,.35), 0 0 0 6px rgba(46,125,50,.14), 0 16px 46px rgba(46,125,50,.32);
--shadow-warn:   0 0 0 1px rgba(249,168,37,.35), 0 0 0 6px rgba(249,168,37,.14), 0 16px 46px rgba(249,168,37,.32);
--shadow-caut:   0 0 0 1px rgba(239,108,0,.35),  0 0 0 6px rgba(239,108,0,.14), 0 16px 46px rgba(239,108,0,.32);
--shadow-danger: 0 0 0 1px rgba(229,57,53,.35),  0 0 0 6px rgba(229,57,53,.14), 0 16px 46px rgba(229,57,53,.32);

  --bg:#1B262C;
  --panel:#0F1A24;
  --panel-2:#13212E;
  --bar:#0E1A27;
  --text:#BBE1FA;
  --muted:#86B9DE;
  --rule:#263A4A;
  --shadow:none;
  --accent:#3282B8;

  --pill-bg:#26465C;
  --pill-border:#3C6E8D;
}

html,body{height:100%}
html, body { overflow-x:hidden; }
*{ box-sizing:border-box }
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family:var(--font); -webkit-font-smoothing:antialiased;
  padding-top:env(safe-area-inset-top);
}

/* global theme fade */
body.theme-fade::before{
  content:""; position:fixed; inset:0; pointer-events:none; background:var(--bg);
  opacity:0; transition:opacity var(--normal) var(--easing); z-index:1;
}
body.theme-fade::before{ opacity:.5 }

body.scrolled .tabs{ box-shadow: 0 6px 14px rgba(0,0,0,.06) }

/* Pull-to-Refresh */
.ptr{
  position:fixed; top:0; left:0; right:0; height:64px; pointer-events:none;
  transform:translateY(0); transition: transform var(--normal) var(--easing);
  z-index:60; opacity:0; display:flex; align-items:flex-end; justify-content:center;
}
.ptr.show{ opacity:1 }
.ptr .ptr-inner{
  margin-bottom:8px; padding:8px 12px; border-radius:999px; border:1px solid var(--rule);
  background:rgba(255,255,255,.7); backdrop-filter:saturate(140%) blur(8px); -webkit-backdrop-filter:saturate(140%) blur(8px);
  color:var(--muted); font-weight:700; display:flex; align-items:center; gap:10px;
}
[data-theme="dark"] .ptr .ptr-inner{
  background:rgba(255,255,255,.10);
  border-color:rgba(255,255,255,.20);
  color:var(--muted);
}

/* Topbar */
.tabs{
  position:sticky; top:0; z-index:50;
  display:flex; align-items:center; gap:10px;
  padding:10px 14px; background:var(--bar); border-bottom:1px solid var(--rule);
  padding-left: calc(14px + env(safe-area-inset-left));
  padding-right: calc(14px + env(safe-area-inset-right));
  transition: background-color var(--normal) var(--easing), border-color var(--normal) var(--easing), box-shadow var(--normal) var(--easing);
}
.tabs .left{position:relative; display:flex; gap:8px; flex-wrap:wrap}
.tab{
  appearance:none; border:1px solid var(--rule); background:var(--panel);
  color:var(--muted); border-radius:var(--radius); padding:10px 14px;
  text-decoration:none; font-weight:600; font-size:15px;
  transition: transform var(--fast) var(--easing), background-color var(--normal) var(--easing), color var(--normal) var(--easing), border-color var(--normal) var(--easing), box-shadow var(--normal) var(--easing);
  will-change: transform;
}
.tab:focus-visible{ outline:3px solid color-mix(in oklab, var(--accent) 35%, #fff); outline-offset:2px; }
.tab:hover{ transform: translateY(-1px) }
.tab:active{ transform: translateY(0) scale(.995) }
.tab.active{color:var(--accent); box-shadow:var(--shadow); border-color:color-mix(in oklab, var(--accent) 40%, var(--rule))}
.tab-indicator{
  position:absolute; left:0; bottom:-6px; height:3px; width:0; background:color-mix(in oklab, var(--accent) 72%, #fff 28%);
  border-radius:999px; transform:translateX(0); transition: transform var(--normal) var(--easing), width var(--normal) var(--easing), opacity var(--fast) var(--easing);
  opacity:0;
}
@media (max-width:980px){
  #tabsInline{ display:none }
}

.spacer{flex:1}
.theme-btn{
  border:1px solid var(--rule); background:var(--panel); color:var(--text);
  border-radius:var(--radius); padding:9px 12px; display:flex; gap:8px; align-items:center; cursor:pointer;
  transition: transform var(--fast) var(--easing), background-color var(--normal) var(--easing), border-color var(--normal) var(--easing);
}
.theme-btn i{font-size:18px}
.theme-btn:hover{ transform: translateY(-1px) }
.theme-btn:active{ transform: translateY(0) scale(.99) }

.hamburger{
  display:none; border:1px solid var(--rule); background:var(--panel); color:var(--text);
  border-radius:var(--radius); padding:10px 12px; cursor:pointer;
  transition: transform var(--fast) var(--easing), background-color var(--normal) var(--easing), border-color var(--normal) var(--easing);
}
.hamburger:hover{ transform: translateY(-1px) }
.hamburger:active{ transform: translateY(0) scale(.99) }
@media (max-width:980px){
  .hamburger{ display:inline-flex; align-items:center; gap:8px }
}

/* Drawer */
.drawer[hidden]{ display:none !important; }
.drawer{ position:fixed; inset:0; z-index:1200; }
.drawer-backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.0); backdrop-filter:saturate(130%) blur(2px); z-index:1;
  transition: background-color var(--normal) var(--easing);
}
.drawer.open .drawer-backdrop{ background:rgba(0,0,0,.3) }
.drawer-panel{
  position:fixed; inset:0 auto 0 0; width:min(86vw, 340px); z-index:2;
  background:var(--panel); border-right:1px solid var(--rule);
  padding:16px; padding-top:calc(16px + env(safe-area-inset-top));
  box-shadow:var(--shadow); display:flex; flex-direction:column; gap:10px;
  transform:translateX(-104%);
  transition: transform var(--normal) var(--easing), background-color var(--normal) var(--easing), border-color var(--normal) var(--easing);
}
.drawer.open .drawer-panel{ transform:translateX(0) }
.drawer-panel .tab{ display:block; width:100%; text-align:left }

.wrap{
  padding:16px clamp(12px, 4vw, 16px);
  padding-left: calc(clamp(12px, 4vw, 16px) + env(safe-area-inset-left));
  padding-right: calc(clamp(12px, 4vw, 16px) + env(safe-area-inset-right));
  max-width:1920px; margin:0 auto
}

/* Route-Karten */
.cards{ display:grid; gap:14px; grid-template-columns:1fr }
@media (min-width:1000px){ .cards{ grid-template-columns:1fr 1fr } }
@media (min-width:1440px){ .cards{ grid-template-columns:1fr 1fr 1fr } }
@media (min-width:1800px){ .cards{ grid-template-columns:1fr 1fr 1fr 1fr } }

.card{
  background:var(--panel); border:1px solid var(--rule); border-radius:var(--radius);
  padding:16px; box-shadow:var(--shadow); min-width:0;
  transition: transform var(--fast) var(--easing), box-shadow var(--normal) var(--easing), background-color var(--normal) var(--easing), border-color var(--normal) var(--easing);
  will-change: transform;
}
.card:hover{ transform: translateY(-1px) }
.card:active{ transform: translateY(0) scale(.995); box-shadow:var(--shadow-press) }
.card .row{ display:flex; align-items:center; gap:12px; flex-wrap:wrap; min-width:0 }
.time{ font-variant-numeric:tabular-nums; font-weight:700; font-size:20px }
.sep{ color:var(--muted) }
.chip{
  display:inline-flex; gap:8px; align-items:center;
  background:var(--pill-bg);
  border:1px solid var(--pill-border);
  border-radius:var(--radius);
  padding:6px 10px; font-weight:600; font-size:14px; color:var(--text);
  white-space:nowrap;
  transition: background-color var(--normal) var(--easing), border-color var(--normal) var(--easing), color var(--normal) var(--easing);
}
.line-chip{
  --line-color: var(--accent);
  font-weight:700;
  background: color-mix(in oklab, var(--pill-bg) 92%, var(--line-color) 8%);
  border:1px solid color-mix(in oklab, var(--pill-border) 55%, var(--line-color) 45%);
  color: var(--line-color);
}
.line-chip::before{ content:none !important; display:none !important; }
[data-theme="dark"] .line-chip{
  background: color-mix(in oklab, var(--pill-bg) 88%, var(--line-color) 12%);
  border-color: color-mix(in oklab, var(--pill-border) 50%, var(--line-color) 50%);
  color: color-mix(in oklab, var(--line-color) 70%, #FFFFFF 30%);
}
.sub{ margin-top:8px; color:var(--muted); font-size:14px }

/* Glas-Badge */
.leave-badge{ position:relative; z-index:0;
  display:inline-flex; align-items:center; gap:8px;
  padding:6px 10px; border-radius:999px;
  border:1px solid var(--rule);
  box-shadow:0 0.5px 0 rgba(0,0,0,.04), 0 6px 18px rgba(0,0,0,.04);
  backdrop-filter:saturate(140%) blur(8px); -webkit-backdrop-filter:saturate(140%) blur(8px);
  background:rgba(255,255,255,.58);
  color:var(--muted);
  margin-bottom:10px;
  transition: background-color var(--normal) var(--easing), border-color var(--normal) var(--easing), color var(--normal) var(--easing);
}
[data-theme="dark"] .leave-badge{
  background:rgba(255,255,255,.10);
  border-color:rgba(255,255,255,.20);
  box-shadow:0 0 0 1px rgba(255,255,255,.06) inset;
  color:var(--muted);
}
.leave-badge i{ opacity:.85; font-size:14px }
.leave-badge .leave-time{ font-size:16px; font-weight:800; font-variant-numeric:tabular-nums }

/* Timeline */
.timeline{
  margin-top:10px; border:1px solid var(--rule); border-radius:var(--radius); padding:10px 12px; background:var(--panel-2);
  display:grid; grid-template-columns:22px 1fr auto; gap:8px 12px;
  transition: background-color var(--normal) var(--easing), border-color var(--normal) var(--easing);
}
.tl-ico{ text-align:center; color:var(--muted) }
.tl-stop{ font-weight:600; min-width:0; overflow-wrap:anywhere }
.tl-meta{ color:var(--muted); font-variant-numeric:tabular-nums }
.actual{ font-weight:700 }
.planned{ font-size:12px; opacity:.75; margin-left:6px }
.late .actual{ color:var(--bad) }
.early .actual{ color:var(--ok) }

@media (max-width:420px){
  .timeline{ grid-template-columns:18px 1fr; }
  .timeline > div:last-child{ grid-column:1 / -1 }
  .tl-meta{ white-space:normal; font-size:13px }
  .chip{ font-size:13px; padding:5px 8px }
}

/* Tabellen */
.panel-table{
  background:var(--panel); border:1px solid var(--rule); border-radius:var(--radius);
  box-shadow:var(--shadow); overflow:hidden; padding:0; margin:0; width:100%;
  transition: background-color var(--normal) var(--easing), border-color var(--normal) var(--easing), box-shadow var(--normal) var(--easing);
}
.table-head{
  margin:0;
  background:var(--bar); border-bottom:1px solid var(--rule);
  display:grid; grid-template-columns:140px 140px 220px 1fr 120px 100px;
  padding:12px 16px; font-weight:700; color:var(--muted);
  transition: background-color var(--normal) var(--easing), border-color var(--normal) var(--easing), color var(--normal) var(--easing);
}
.table-head i{ margin-right:8px; opacity:.8 }
.rows{ margin:0 }
.row-item{
  display:grid; grid-template-columns:140px 140px 220px 1fr 120px 100px; align-items:center;
  padding:14px 16px; border-bottom:1px solid var(--rule); background:var(--panel);
  min-width:0;
  transition: background-color var(--normal) var(--easing);
}
.row-item:hover{ background: color-mix(in oklab, var(--panel) 92%, var(--bar) 8%); }
.delta{ font-variant-numeric:tabular-nums; font-weight:700 }
.delta.late{ color:var(--bad) } .delta.early{ color:var(--ok) } .delta.ontime{ color:var(--muted) }

@media (max-width:900px){
  .table-head, .row-item{ grid-template-columns:120px 1fr 80px 64px; }
  .col-plan, .col-steig { display:none }
  .row-item, .table-head { padding:12px 14px }
}
@media (max-width:420px){
  .table-head, .row-item{ grid-template-columns:100px 1fr 70px 54px; }
  .row-item, .table-head { padding:10px 12px }
}

/* Footer & Buttons */
.footer{
  margin:16px; padding:10px 14px; color:var(--muted); font-size:13px;
  background:var(--panel); border:1px solid var(--rule); border-radius:var(--radius); box-shadow:var(--shadow);
  transition: background-color var(--normal) var(--easing), border-color var(--normal) var(--easing), box-shadow var(--normal) var(--easing);
}
.footer-space{ height:64px }

.more-wrap{ padding:10px 0 0; display:flex; justify-content:center; gap:8px; flex-wrap:wrap }
.btn{
  border:1px solid var(--pill-border);
  background:var(--pill-bg);
  border-radius:var(--radius);
  padding:10px 14px; font-weight:700; cursor:pointer;
  color:var(--text);
  transition: transform var(--fast) var(--easing), background-color var(--normal) var(--easing), border-color var(--normal) var(--easing);
}
.btn:hover{
  background: color-mix(in oklab, var(--pill-bg) 90%, #FFFFFF 10%);
  transform: translateY(-1px);
}
[data-theme="dark"] .btn:hover{
  background: color-mix(in oklab, var(--pill-bg) 80%, #BBE1FA 20%);
}
.btn:active{ transform: translateY(0) scale(.99) }
.btn:disabled{ opacity:.6; cursor:not-allowed }
.hint{padding:12px 14px; color:var(--muted)}
.badge{ font-size:12px; opacity:.8; }

body.drawer-open{ overflow:hidden }

/* Skeleton Loader */
@keyframes shimmer{
  0%{ background-position:-400px 0 }
  100%{ background-position:400px 0 }
}
.skeleton{ position:relative; overflow:hidden; }
.skeleton .s-row,.skeleton .s-chip,.skeleton .s-timeline{
  border-radius:10px;
  background: linear-gradient(90deg, rgba(0,0,0,0.06) 25%, rgba(0,0,0,0.12) 37%, rgba(0,0,0,0.06) 63%);
  background-size: 800px 100%;
  animation: shimmer 1.2s infinite linear;
  opacity:.6;
}
[data-theme="dark"] .skeleton .s-row,[data-theme="dark"] .skeleton .s-chip,[data-theme="dark"] .skeleton .s-timeline{
  background: linear-gradient(90deg, rgba(255,255,255,0.06) 25%, rgba(255,255,255,0.14) 37%, rgba(255,255,255,0.06) 63%);
}
.s-row{ height:16px; margin:8px 0 }
.s-chip{ height:28px; width:120px; margin:8px 8px 8px 0; display:inline-block }
.s-timeline{ height:56px; margin-top:8px }
.s-w20{ width:20% } .s-w30{ width:30% } .s-w40{ width:40% } .s-w50{ width:50% } .s-w60{ width:60% } .s-w70{ width:70% } .s-w80{ width:80% }

@media (max-width:900px){ .hide-sm{ display:none } }


/* === Mobile readability layout (â¤ 520px) ===
   - Fix timeline so times move below stop names per row
   - Prevent per-letter wrapping of stop names
   - Tweak typography and spacing for small screens
   - Keep desktop/tablet layout unchanged
*/
@media (max-width: 520px){
  .card{ padding:14px }
  .card .row{ gap:10px }
  .time{ font-size: clamp(18px, 6vw, 22px); line-height: 1.2 }
  .chip{ font-size:13px; padding:5px 8px }
  .leave-badge{ padding:5px 9px }

  /* Timeline becomes two columns: icon + content. The time/meta moves below the stop name for EVERY row */
  .timeline{ grid-template-columns:22px 1fr; }
  .timeline > div:nth-child(3n){ grid-column:2 / -1; text-align:left; } /* each third cell (the meta/time) breaks to next line */
  .timeline .tl-stop{ overflow-wrap:normal; word-break:normal; hyphens:auto; } /* prevent per-letter breaks */
  .timeline .tl-meta{ font-size:13px; }
}

@media (max-width: 360px){
  .chip{ font-size:12px; padding:4px 6px }
  .time{ font-size:18px }
}


/* === Mobile interaction/perf fixes ===
   - Stop hover jitter on touch devices
   - Keep hover animation lightweight on pointer devices
   - Reduce repaint scope and promote cards to their own layer
   - Avoid scroll chaining during pull-to-refresh
*/
html, body{
  overscroll-behavior-y: contain;
}

.card, .route-card, article.card, .result-card{
  backface-visibility: hidden;
  transform: translateZ(0);
  will-change: transform;
  contain: paint;
}

/* Hover animations only on devices that actually support hover */
@media (hover: hover){
  .card, .route-card, article.card, .result-card{
    transition: transform 160ms cubic-bezier(.2,.8,.2,1);
  }
  .card:hover, .route-card:hover, article.card:hover, .result-card:hover,
  .card:focus-within, .route-card:focus-within, article.card:focus-within, .result-card:focus-within{
    transform: translateY(-2px);
  }
}

/* On touch devices: disable hover effects entirely to prevent flicker while scrolling */
@media (hover: none){
  .card:hover, .route-card:hover, article.card:hover, .result-card:hover{
    transform: none !important;
  }
}


/* ===== Delay-based card emphasis ===== */
.card.is-early{
  box-shadow: var(--shadow-early);
  border-color: color-mix(in oklab, var(--pill-border, #0000) 55%, var(--tone-early) 45%);
}
.card.is-late-1{ /* +1 to +4 minutes (yellow) */
  box-shadow: var(--shadow-warn);
  border-color: color-mix(in oklab, var(--pill-border, #0000) 55%, var(--tone-warn) 45%);
}
.card.is-late-5{ /* +5 to +9 minutes (orange) */
  box-shadow: var(--shadow-caut);
  border-color: color-mix(in oklab, var(--pill-border, #0000) 55%, var(--tone-caut) 45%);
}
.card.is-late-10{ /* +10 minutes or more (red) */
  box-shadow: var(--shadow-danger);
  border-color: color-mix(in oklab, var(--pill-border, #0000) 55%, var(--tone-danger) 45%);
}

/* Optional accents for inner elements (timeline etc.) */
.card.is-early .timeline{ border-color: color-mix(in oklab, var(--rule, #0000) 60%, var(--tone-early) 40%); }
.card.is-late-1 .timeline{ border-color: color-mix(in oklab, var(--rule, #0000) 60%, var(--tone-warn) 40%); }
.card.is-late-5 .timeline{ border-color: color-mix(in oklab, var(--rule, #0000) 60%, var(--tone-caut) 40%); }
.card.is-late-10 .timeline{ border-color: color-mix(in oklab, var(--rule, #0000) 60%, var(--tone-danger) 40%); }


/* === Pin control for route cards (injected) === */
.card{ position:relative; }

.pin-btn{
  position:absolute; top:10px; right:10px; z-index:2;
  display:inline-flex; align-items:center; justify-content:center;
  width:34px; height:34px;
  border-radius:999px; border:1px solid var(--pill-border);
  background:var(--pill-bg); color:var(--muted);
  box-shadow:var(--shadow-press);
  opacity:0; transform: translateY(-2px) scale(.96);
  transition: opacity var(--fast) var(--easing), transform var(--fast) var(--easing), background-color var(--normal) var(--easing), border-color var(--normal) var(--easing), color var(--normal) var(--easing);
  cursor:pointer;
}
.card:hover .pin-btn{ opacity:1; transform: translateY(0) scale(1) }
.pin-btn:focus-visible{ outline:3px solid color-mix(in oklab, var(--accent) 35%, #fff); outline-offset:2px }
.pin-btn[aria-pressed="true"]{
  color: var(--accent);
  border-color: color-mix(in oklab, var(--pill-border) 40%, var(--accent) 60%);
  background: color-mix(in oklab, var(--pill-bg) 85%, var(--accent) 15%);
}
.pin-btn[aria-pressed="true"] i{ transform: rotate(-25deg) }
.pin-btn i{ font-size:14px; opacity:.95; transition: transform var(--fast) var(--easing) }

.card.pinned{ outline: 2px dashed color-mix(in oklab, var(--accent) 60%, #fff 40%); outline-offset: 2px }

@media (hover: none){
  .pin-btn{ opacity:.9; }
}

#pinnedToggle[aria-pressed="true"]{
  color: var(--accent);
  border-color: color-mix(in oklab, var(--pill-border) 40%, var(--accent) 60%);
  background: color-mix(in oklab, var(--pill-bg) 84%, var(--accent) 16%);
}

/* ==== Card animation removal overrides (generated) ==== */
.card, article.card, .route-card, .result-card{
  transition: none !important;
  will-change: auto !important;
}
@media (hover:hover){
  .card:hover, .route-card:hover, article.card:hover, .result-card:hover{
    transform: none !important;
  }
}
.card:active, .route-card:active, article.card:active, .result-card:active{
  transform: none !important;
}
.card:focus-within, .route-card:focus-within, article.card:focus-within, .result-card:focus-within{
  transform: none !important;
}


/* === Trip Modal & RIS === */
.modal[hidden]{display:none!important}
.modal{position:fixed;inset:0;z-index:1300;display:grid;place-items:center}
.modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.28);backdrop-filter:blur(2px)}
.modal-panel{overscroll-behavior:contain; position:relative;width:min(1040px,96vw);max-height:86vh;overflow:auto;background:var(--panel);color:var(--text);border:1px solid var(--rule);border-radius:var(--radius);box-shadow:var(--shadow)}
.modal-head{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 16px;background:var(--bar);border-bottom:1px solid var(--rule)}
.modal-body{padding:14px 16px}
.modal-close{border:1px solid var(--rule);background:var(--panel);color:var(--text);border-radius:999px;width:34px;height:34px;display:grid;place-items:center}
.trip-meta{display:flex;flex-wrap:wrap;gap:8px;margin:0 0 10px}
.trip-section-title{font-weight:700;margin:6px 0 4px;opacity:.9}
.trip-stops{border:1px solid var(--rule);background:var(--panel-2);border-radius:var(--radius);display:grid;grid-template-columns:140px 1fr 120px;gap:8px 12px;padding:10px 12px}
.trip-stops .hdr{color:var(--muted);font-weight:700}
.trip-stops .row{display:contents}
.trip-stops .time{font-variant-numeric:tabular-nums}
.trip-stops .late .actual,.trip-stops .late{color:var(--bad)}
.trip-stops .early .actual,.trip-stops .early{color:var(--ok)}
.trip-stops .planned{opacity:.7;font-size:.95em}
.trip-stops .plat{text-align:right}
.trip-ris{border:1px solid var(--rule);background:var(--panel-2);border-radius:var(--radius);padding:10px 12px;margin:0 0 12px}
.ris-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:10px}
.ris-item{display:flex;gap:10px;align-items:flex-start}
.ris-item i{margin-top:3px}
.ris-title{font-weight:600}
.ris-desc{opacity:.9}
.line-chip.clickable{cursor:pointer;outline:none}
@media (max-width:560px){.trip-stops{grid-template-columns:100px 1fr}.trip-stops .plat{display:none}}


/* === Premium Trip Modal === */
.trip-panel{overflow:hidden}
.trip-head{
  display:grid; grid-template-columns:auto 1fr auto; align-items:center;
  gap:14px; padding:12px 16px; background:var(--bar);
  border-bottom:1px solid var(--rule); position:sticky; top:0; z-index:1;
}
.trip-line{display:flex;align-items:center}
.line-pill{
  display:inline-flex; align-items:center; justify-content:center; padding:6px 12px;
  border-radius:999px; border:1px solid var(--rule); background:var(--panel); font-weight:700;
}
.trip-center{min-width:0}
.trip-dest{font-weight:800; font-size:1.15rem; letter-spacing:.2px; line-height:1.15}
.trip-meta-row{opacity:.8; font-size:.95rem; margin-top:2px}

.trip-body{display:flex; flex-direction:column; gap:12px}
.feature-chips{display:flex; flex-wrap:wrap; gap:8px; margin:4px 0 2px}
.feature-chips .chip{background:var(--panel-2); border:1px solid var(--rule)}
.skeleton .bar{height:10px; background:var(--panel-2); border-radius:6px; margin:8px 0; animation:pulse 1.2s infinite}
.skeleton .bar.w50{width:50%}
@keyframes pulse{0%{opacity:.6}50%{opacity:1}100%{opacity:.6}}

.trip-ris{border:1px solid var(--rule); background:var(--panel-2); border-radius:var(--radius); padding:12px; margin-top:4px}
.trip-section-title{font-weight:700; margin:0 0 10px; opacity:.95}
.ris-list{list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:8px}
.ris-item{display:flex; gap:10px; align-items:flex-start}
.ris-item i{margin-top:3px}
.ris-title{font-weight:600}
.ris-desc{opacity:.9}

.trip-scroll{display:flex; flex-direction:column; gap:10px}
.trip-stops{border:1px solid var(--rule); background:var(--panel-2); border-radius:var(--radius);}
.trip-stops.sticky{position:sticky; top:0; z-index:0}
.trip-stops.scroll{max-height:56vh; overflow:auto; padding:10px 12px}

.trip-stops .hdr{color:var(--muted); font-weight:700; padding:0 0 6px}
.trip-stops .row{display:grid; grid-template-columns:24px minmax(110px, 170px) 1fr minmax(90px, 120px); gap:8px 12px; align-items:start; padding:6px 0; position:relative}
.trip-stops .rail{position:relative}
.trip-stops .rail::before{
  content:""; position:absolute; left:9px; top:-16px; bottom:-16px; width:2px; background:var(--rule);
}
.trip-stops .dot{display:block; width:10px; height:10px; border-radius:999px; background:var(--muted); position:relative; top:6px; left:4px}
.trip-stops .row.now .dot{background:var(--accent, #4f8cff)}
.trip-stops .time{font-variant-numeric:tabular-nums}
.trip-stops .late .actual,.trip-stops .late{color:var(--bad)}
.trip-stops .early .actual,.trip-stops .early{color:var(--ok)}
.trip-stops .planned{opacity:.7; font-size:.95em}
.trip-stops .plat{text-align:right}

@media (max-width:560px){
  .trip-stops .row{display:grid; grid-template-columns:24px minmax(110px, 170px) 1fr minmax(90px, 120px); position:relative}
\1 var(--accent-band, linear-gradient(90deg, var(--accent-chip, var(--accent, #7aa6ff)), color-mix(in oklab, var(--accent-chip, var(--accent, #7aa6ff)) 82%, #fff 18%)));
}
.trip-head{
  display:grid; grid-template-columns:auto 1fr auto; align-items:center;
  gap:14px; padding:12px 16px; background:var(--bar);
  border-bottom:1px solid var(--rule); position:sticky; top:0; z-index:1;
}
.trip-line{display:flex;align-items:center}
.line-pill{
  display:inline-flex; align-items:center; justify-content:center; padding:6px 12px;
  border-radius:999px; border:1px solid var(--rule); background:var(--panel); font-weight:700;
}
.trip-center{min-width:0}
.trip-dest{font-weight:800; font-size:1.18rem; letter-spacing:.2px; line-height:1.15}
.trip-meta-row{opacity:.85; font-size:.95rem; margin-top:2px}
.trip-body{display:flex; flex-direction:column; gap:12px}

/* Accent palette per product */
.trip-panel.prod-fern{ --accent-band: linear-gradient(90deg, #d50000, #ff6b6b); }
.trip-panel.prod-regional{ --accent-band: linear-gradient(90deg, #0ea5e9, #38bdf8); }
.trip-panel.prod-sbahn{ --accent-band: linear-gradient(90deg, #10b981, #34d399); }
.trip-panel.prod-ubahn{ --accent-band: linear-gradient(90deg, #6366f1, #a78bfa); }
.trip-panel.prod-tram{ --accent-band: linear-gradient(90deg, #f97316, #fb923c); }
.trip-panel.prod-bus{ --accent-band: linear-gradient(90deg, #f59e0b, #fbbf24); }
.trip-panel.prod-other{ --accent-band: linear-gradient(90deg, #7aa6ff, #9cc2ff); }

/* RIS block */
.trip-ris{border:1px solid var(--rule); background:var(--panel-2); border-radius:var(--radius); padding:12px; margin-top:4px}
.trip-section-title{font-weight:700; margin:0 0 10px; opacity:.95}
.ris-list{list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:8px}
.ris-item{display:flex; gap:10px; align-items:flex-start}
.ris-item i{margin-top:3px}
.ris-desc{opacity:.95;}

/* Feature chips */
.feature-chips{display:flex; flex-wrap:wrap; gap:8px; margin:4px 0 2px}
.feature-chips .chip{background:var(--panel-2); border:1px solid var(--rule)}

/* Table/Stopovers (fixed clipping) */
.trip-stops{border:1px solid var(--rule); background:var(--panel-2); border-radius:var(--radius);}
.trip-stops .table{max-height:56vh; overflow:auto; padding:8px 12px 12px}
.trip-stops .thead{position:sticky; top:0; display:grid; grid-template-columns:24px minmax(110px, 170px) 1fr minmax(90px, 120px); gap:8px 12px; background:var(--panel-2); padding:8px 0; border-bottom:1px solid var(--rule); z-index:1}
.trip-stops .tbody{display:block}
.trip-stops .row{display:grid; grid-template-columns:24px minmax(110px, 170px) 1fr minmax(90px, 120px); gap:8px 12px; align-items:start; padding:8px 0; position:relative}
.trip-stops .rail{position:relative}
.trip-stops .rail::before{content:""; position:absolute; left:11px; top:0; bottom:0; width:2px; background:var(--rule);}
.trip-stops .dot{display:block; width:10px; height:10px; border-radius:999px; background:var(--muted); position:relative; top:3px; left:6px}
.trip-stops .time{font-variant-numeric:tabular-nums}
.trip-stops .late .actual,.trip-stops .late{color:var(--bad)}
.trip-stops .early .actual,.trip-stops .early{color:var(--ok)}
.trip-stops .planned{opacity:.7;font-size:.95em}
.trip-stops .plat{text-align:right}

@media (max-width:560px){
  .trip-stops .thead,
  .trip-stops .row{display:grid; grid-template-columns:24px minmax(110px, 170px) 1fr minmax(90px, 120px); position:relative}
\1 var(--accent-band, linear-gradient(90deg, var(--accent-chip, var(--accent, #7aa6ff)), color-mix(in oklab, var(--accent-chip, var(--accent, #7aa6ff)) 82%, #fff 18%)));
}
.trip-head{
  display:grid; grid-template-columns:auto 1fr auto; align-items:center;
  gap:14px; padding:12px 16px; background:var(--bar);
  border-bottom:1px solid var(--rule); position:sticky; top:0; z-index:1;
}
.trip-line{display:flex;align-items:center}
.line-pill{
  display:inline-flex; align-items:center; justify-content:center; padding:6px 12px;
  border-radius:999px; border:1px solid var(--rule); background:var(--panel); font-weight:700;
}
.trip-center{min-width:0}
.trip-dest{font-weight:800; font-size:1.18rem; letter-spacing:.2px; line-height:1.15}
.trip-meta-row{opacity:.85; font-size:.95rem; margin-top:2px}

/* RIS block */
.trip-ris{border:1px solid var(--rule); background:var(--panel-2); border-radius:var(--radius); padding:12px; margin-top:4px}
.trip-section-title{font-weight:700; margin:0 0 10px; opacity:.95}
.ris-list{list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:8px}
.ris-item{display:flex; gap:10px; align-items:flex-start}
.ris-item i{margin-top:3px}
.ris-desc{opacity:.95;}

/* Stop list */
.trip-stops{border:1px solid var(--rule); background:var(--panel-2); border-radius:var(--radius);}
.trip-stops .table{max-height:56vh; overflow:auto; padding:8px 12px 12px}
.trip-stops .thead{position:sticky; top:0; display:grid; grid-template-columns:24px minmax(110px, 170px) 1fr minmax(90px, 120px); gap:8px 12px; background:var(--panel-2); padding:8px 0; border-bottom:1px solid var(--rule); z-index:1}
.trip-stops .tbody{display:block}
.trip-stops .row{display:grid; grid-template-columns:24px minmax(110px, 170px) 1fr minmax(90px, 120px); gap:8px 12px; align-items:start; padding:10px 0; position:relative}
.trip-stops .rail{position:relative}
.trip-stops .rail::before{content:""; position:absolute; left:11px; top:-10px; bottom:-10px; width:2px; background:var(--rule);}
.trip-stops .dot{display:block; width:10px; height:10px; border-radius:999px; background:var(--muted); position:relative; top:2px; left:6px}

.trip-stops .time{font-variant-numeric:tabular-nums}
.trip-stops .time .tline{line-height:1.18; margin:0}
.trip-stops .time .lbl{font-size:.75em; text-transform:uppercase; letter-spacing:.04em; opacity:.7; margin-right:6px}
.trip-stops .planned{opacity:.6; font-size:.95em}
.trip-stops .late .actual,.trip-stops .late{color:var(--bad)}
.trip-stops .early .actual,.trip-stops .early{color:var(--ok)}
.trip-stops .plat{text-align:right; white-space:nowrap}

@media (max-width:560px){
  .trip-stops .thead,
  .trip-stops .row{grid-template-columns:24px 120px 1fr}
  .trip-stops .thead .plat-h, .trip-stops .plat{display:none}
}
